#!/bin/bash
# Avahi ssh client script
# (C) Keto, 2010
echo -ne "\033]2;ASSh\007"

LIST=`avahi-browse -tpr _ssh._tcp|grep -e "^="|\
 cut -d ';' -f 2,3,4,8,9 --output-delimiter ' '`
SELECTION=`zenity --list --title "ASSh" --text "Select host" \
 --column "if" --column "ipv" --column "host" --column "address" \
 --column "port" --print-column ALL --separator ' ' $LIST`

if [ ! -z "$SELECTION" ]; then
    DATA=($SELECTION)
    HOST=${DATA[3]}
    PORT=${DATA[4]}
    [ "${DATA[1]}" = "IPv6" ] && HOST=$HOST%${DATA[0]}
    ssh -p $PORT $HOST $@
fi
